;/*FB_PKG_DELIM*/

__d("ReStoreIDBFactory",["invariant","Deferred","I64","IndexedDbPolyfills","ReStoreKeyComparer","err","nullthrows","promiseDone","setImmediate","unrecoverableViolation"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k="e2ee_";function l(a){var b=new Map();function c(a){if(typeof a!=="object"||a===null)return a;if(b.has(a))return b.get(a);var d;if(Array.isArray(a)){d=[];b.set(a,d);for(var e of a)d.push(c(e))}else if(a instanceof Set){d=new Set();b.set(a,d);for(e of a)d.add(c(e))}else if(a instanceof Map){d=new Map();b.set(a,d);for(e of a){var f=e[0],g=e[1];d.set(c(f),c(g))}}else if(a instanceof ArrayBuffer)d=new ArrayBuffer(a.byteLength),new Uint8Array(d).set(new Uint8Array(a));else if(a instanceof Uint8Array){f=c(a.buffer);d=new Uint8Array(f,a.byteOffset,a.length)}else d={};b.set(a,d);for(g of Object.keys(a))d[g]=c(a[g]);return d}return c(a)}function m(a,b){a=[].concat(a);b!==-1&&(a[b]=(i||(i=d("I64"))).to_float(c("nullthrows")(i.cast(a[b]),"Expected autoincrementing field to be an I64")));return a.length===1?a[0]:a}function n(a,b){a=Array.isArray(a)?a:[a];return a.map(function(a,c){if(a===-Infinity)return void 0;if(Array.isArray(a)&&a.length===0)return(j||(j=d("ReStoreKeyComparer"))).MAX_KEY;if(Array.isArray(a)&&a.length===1&&Array.isArray(a[0])&&a[0].length===0)return(j||(j=d("ReStoreKeyComparer"))).MAX_KEY;return c===b&&typeof a==="number"?(i||(i=d("I64"))).of_float(a):a})}function o(a,b,e){var f=a.indexes,g=a.primaryKeyIds;g=e==null?g:f[e];f=g.map(function(f){if(b[f]!==void 0||e!=null){var g=b[f];if(a.autoIncrement&&f===a.primaryKeyIds[0]){g=(i||(i=d("I64"))).cast(g);if(g==null)throw c("unrecoverableViolation")("expected auto-incrementing field to be an i64","messenger_web_product");g=i.to_float(g)}return g}throw c("unrecoverableViolation")("primary key must be defined on object","messenger_web_product")});return f.length===1?f[0]:f}var p=function(){function a(a){this.$1=a}var b=a.prototype;b.continue=function(a){this.$1(a)};b.advance=function(a){for(var b=0;b<a;b++)this.continue()};return a}(),q=function(){function a(a,b,c,d){this.$1=a,this.$2=b,this.$3=c,this.$4=d}var b=a.prototype;b.openCursor=function(a,b){var c=this;return u(a,b,function(a){return a.table(c.$3).index(c.$1)},this.$4,this.$2,this.$1)};b.count=function(a){var b=this,c=this.$2.autoIncrement?this.$2.indexes[this.$1].indexOf(this.$2.primaryKeyIds[0]):-1;return this.$4(new(d("IndexedDbPolyfills").IDBRequest)(),async function(d){var e=new WeakMap();d=await d.table(b.$3).index(b.$1).keys(e,"asc",t(a,c));e=0;var f=await d.next();while(!f.done)e++,f=await d.next();return e})};babelHelpers.createClass(a,[{key:"keyPath",get:function(){return this.$2.indexes[this.$1].length===1?this.$2.indexes[this.$1][0]:this.$2.indexes[this.$1]}},{key:"name",get:function(){return this.$1}}]);return a}();function r(a,b){if(b==null)return a;var e=c("nullthrows")((i||(i=d("I64"))).cast(a[b]),"expected auto-increment field to be an I64");a[b]=i.to_float(e);return a}function s(a,b){if(b==null||a[b]==null)return babelHelpers.extends({},a);typeof a[b]==="number"||h(0,72542);a[b]=(i||(i=d("I64"))).of_float(a[b]);return a}function t(a,b){var c;a!=null&&(c={},a.lower!==void 0&&(a.lowerOpen?c.gt=n(a.lower,b):c.gte=n(a.lower,b)),a.upper!==void 0&&(a.upperOpen?c.lt=n(a.upper,b):c.lte=n(a.upper,b)));return c}function u(a,b,e,f,g,h){var i=g.autoIncrement?h==null?0:g.indexes[h].indexOf(g.primaryKeyIds[0]):-1,k=g.autoIncrement?g.primaryKeyIds[0]:null,q="asc";if(b==="prev")q="desc";else if(b!==void 0&&b!=="next")throw c("err")("Unsupported direction:"+b);var s=new WeakMap(),u=new(d("IndexedDbPolyfills").IDBRequest)(),v,w=new p(x);u.result=w;function x(b){var c;b!=null&&(c=n(b,i));f(u,async function(b){var f;v=(f=v)!=null?f:e(b).entries(s,q,t(a,i));var h=v,n=await h.next(c);f=async function(){var a=n.value[0];for(var b=0;b<a.length;b++){var c=a.slice(0,b);if(q==="asc"){if(a[b]==null){if(b===a.length-1)n=await h.next();else{var e=[].concat(c,[void 0,(j||(j=d("ReStoreKeyComparer"))).MAX_KEY]);n=await h.next(e)}if(n.done)return"break|outer";a=n.value[0];if(!c.every(function(b,c){return(j||(j=d("ReStoreKeyComparer"))).compareValue(b,a[c])===0}))return"continue|outer"}}else if(a[b]==null){n=await h.next(c);return"continue|outer"}}return"break"};outer:while(!n.done){b=await f();switch(b){case"break|outer":break outer;case"continue|outer":continue outer;case"break":break outer}}if(!n.done){b=m(n.value[0],i);w.primaryKey=o(g,n.value[1]);w.key=b;w.value=r(l(n.value[1]),k);return w}})}x();return u}var v=function(){function a(a,b,c){this.$1=a,this.$2=b,this.$3=this.$1.getTableData().tableNames[this.$2],this.$4=c}var b=a.prototype;b.index=function(a){return new q(a,this.$3,this.$2,this.$4)};b.get=function(a){var b=this;return this.$4(new(d("IndexedDbPolyfills").IDBRequest)(),async function(c){c=await (c=c.table(b.$2)).get.apply(c,n(a,b.$3.autoIncrement?0:-1));return c==null?c:r(l(c),b.$3.autoIncrement?b.$3.primaryKeyIds[0]:null)})};b.clear=function(){var a=this;return this.$4(new(d("IndexedDbPolyfills").IDBRequest)(),async function(b){var c=b.table(a.$2).entries(new WeakMap()),d=await c.next();while(!d.done){var e;await (e=b.table(a.$2)).delete.apply(e,d.value[0]);d=await c.next()}})};b.put=function(a,b){var c=this,e=s(l(a),this.$3.autoIncrement?this.$3.primaryKeyIds[0]:null);b==null||h(0,72438);return this.$4(new(d("IndexedDbPolyfills").IDBRequest)(),async function(a){await a.table(c.$2).put(e);return o(c.$1.getTableData().tableNames[c.$2],e)})};b.add=function(a,b){var c=this,e=s(l(a),this.$3.autoIncrement?this.$3.primaryKeyIds[0]:null);b==null||h(0,72437);return this.$4(new(d("IndexedDbPolyfills").IDBRequest)(),async function(a){await a.table(c.$2).add(e);return o(c.$1.getTableData().tableNames[c.$2],e)})};b.delete=function(a){var b=this;return this.$4(new(d("IndexedDbPolyfills").IDBRequest)(),async function(c){if(a instanceof IDBKeyRange){var d=new WeakMap(),e=b.$3.autoIncrement?0:-1;d=await c.table(b.$2).entries(d,"asc",t(a,e));e=await d.next();while(!e.done){var f;await (f=c.table(b.$2)).delete.apply(f,e.value[0]);e=await d.next()}}else{await (f=c.table(b.$2)).delete.apply(f,n(a,b.$3.autoIncrement?0:-1))}return void 0})};b.openCursor=function(a,b){var c=this;return u(a,b,function(a){return a.table(c.$2)},this.$4,this.$3)};b.count=function(a){var b=this,c=this.$3.autoIncrement?0:-1;return this.$4(new(d("IndexedDbPolyfills").IDBRequest)(),async function(d){var e=new WeakMap();d=await d.table(b.$2).keys(e,"asc",t(a,c));e=0;var f=await d.next();while(!f.done)e++,f=await d.next();return e})};b.createIndex=function(a,b){};b.deleteIndex=function(a){};babelHelpers.createClass(a,[{key:"indexNames",get:function(){return Object.keys(this.$3.indexes)}},{key:"name",get:function(){return this.$2.substr(k.length)}},{key:"autoIncrement",get:function(){return this.$3.autoIncrement}},{key:"keyPath",get:function(){return this.$3.primaryKeyIds.length===1?this.$3.primaryKeyIds[0]:this.$3.primaryKeyIds}}]);return a}(),w=function(b){babelHelpers.inheritsLoose(a,b);function a(a,d,e,f){var g;g=b.call(this)||this;g.$ReStoreIDBTransaction5=[];g.$ReStoreIDBTransaction6=new(c("Deferred"))();g.state="active";g.oncomplete=null;g.onerror=null;g.$ReStoreIDBTransaction1=a;g.$ReStoreIDBTransaction4=d;g.$ReStoreIDBTransaction3=e;g.$ReStoreIDBTransaction2=f;c("promiseDone")(g.$ReStoreIDBTransaction1.runInTransaction(function(a){g.$ReStoreIDBTransaction6.resolve(a);return new Promise(function(b,d){var e=async function e(){var f=[].concat(g.$ReStoreIDBTransaction5);if(g.state==="finished"){d();throw c("err")("Transaction aborted")}if(!f.length){g.state="committing";return b()}try{g.state="inactive";var h=[];for(var i of f){i[0];var j=i[1];try{j={status:"fulfilled",value:await j(a)}}catch(a){j={reason:a,status:"rejected"}}h.push(j)}g.state="active";g.$ReStoreIDBTransaction5=[];for(j=0;j<h.length;j++){i=h[j];var k=f[j];k=k[0];i.status==="fulfilled"?(k.result=i.value,k.emit("success",{target:k})):(k.error=i.reason,k.emit("error",{target:k}))}}catch(a){return d(a)}c("setImmediate")(function(){return c("promiseDone")(e())})};c("setImmediate")(function(){return c("promiseDone")(e())})})},f==="versionchange"?"readwrite":f),function(){g.state="finished",g.emit("complete"),g.$ReStoreIDBTransaction6=new(c("Deferred"))()},function(){g.state="finished",g.emit("error"),g.$ReStoreIDBTransaction6=new(c("Deferred"))()});return g}var e=a.prototype;e.objectStore=function(a){var b=this;if(!this.$ReStoreIDBTransaction3.has(a))throw c("err")("Invalid object store name "+a);return new v(this.$ReStoreIDBTransaction1,k+a,function(a,d){if(b.state!=="active")throw c("err")("Cannot make request against inactive transaction.");b.$ReStoreIDBTransaction5.push([a,d]);return a})};e.abort=function(){this.state="finished"};e.enqueueAdditionalWork=function(a){this.$ReStoreIDBTransaction5.push([new(d("IndexedDbPolyfills").IDBRequest)(),a])};babelHelpers.createClass(a,[{key:"db",get:function(){return this.$ReStoreIDBTransaction4}},{key:"transaction",get:function(){return this.$ReStoreIDBTransaction6.getPromise()}}]);return a}(d("IndexedDbPolyfills").IDBRequest),x=function(){function a(a,b){this.$1=a,this.$2=b}var b=a.prototype;b.transaction=function(a,b,c){return new w(this.$1,this,new Set(Array.isArray(a)?a:[a]),b)};b.createObjectStore=function(a){return{createIndex:function(a,b,c){}}};b.close=function(){this.$1.closeDb==null?void 0:this.$1.closeDb()};babelHelpers.createClass(a,[{key:"objectStoreNames",get:function(){var a=Object.keys(this.$1.getTableData().tableNames).filter(function(a){return a.startsWith(k)}).map(function(a){return a.substr(k.length)});a.contains=function(b){return a.find(function(a){return a===b})!=null};return a}},{key:"name",get:function(){return this.$2}}]);return a}();b=function(){function a(a){this.$1=a}var b=a.prototype;b.open=function(a,b){var e=new(d("IndexedDbPolyfills").IDBRequest)();e.result=new x(this.$1,a);c("setImmediate")(function(){return e.emit("success")});return e};b.cmp=function(a,b){return indexedDB.cmp(a,b)};return a}();e=function(){function b(){}b.bound=function(c,d,e,f){if(Array.isArray(c)&&c[0]===void 0)return b.upperBound(d,f);return Array.isArray(d)&&d[0]===void 0?b.lowerBound(c,e):a.IDBKeyRange.bound(c,d,e,f)};b.lowerBound=function(b,c){if(Array.isArray(b)&&b[0]===null)return null;return Array.isArray(b)&&b[0]===void 0?null:a.IDBKeyRange.lowerBound(b,c)};b.upperBound=function(b,c){if(Array.isArray(b)&&b[0]===null)return null;return Array.isArray(b)&&b[0]===void 0?null:a.IDBKeyRange.upperBound(b,c)};return b}();g.structuredClone=l;g.ReStoreIDBTransaction=w;g.ReStoreIDBDatabase=x;g.ReStoreIDBFactory=b;g.ReStoreIDBKeyRange=e}),98);
__d("MWPFeatureLimitedData",["I64","LSFeatureLimitsType","LSIntEnum","LSMessagingThreadTypeUtil","ReQL","ReQLSuspense","ServerTime","gkx","useReStore","useServerTime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=[(i||(i=d("LSIntEnum"))).ofNumber(c("LSFeatureLimitsType").READ_ONLY),i.ofNumber(c("LSFeatureLimitsType").GENERIC_READ_ONLY_BLOCK),i.ofNumber(c("LSFeatureLimitsType").MESSAGE_SEND)];function l(a){for(var b=0;b<k.length;b++){var c=k[b];if((j||(j=d("I64"))).equal(c,a.type_))return!0}return!1}function m(a,b){return(j||(j=d("I64"))).equal((i||(i=d("LSIntEnum"))).ofNumber(c("LSFeatureLimitsType").MESSAGE_SEND_PUBLIC),a.type_)&&d("LSMessagingThreadTypeUtil").isPublicCMThread(b)&&c("gkx")("9277")}function n(a,b){return(j||(j=d("I64"))).equal((i||(i=d("LSIntEnum"))).ofNumber(c("LSFeatureLimitsType").MESSAGE_SEND_PRIVATE),a.type_)&&d("LSMessagingThreadTypeUtil").isPrivateThread(b)&&c("gkx")("9278")}var o=function(a){var b=(j||(j=d("I64"))).of_float(d("ServerTime").getMillis()/1e3);return d("ReQL").fromTableAscending(a.table("feature_limits")).filter(function(a){return l(a)&&(j||(j=d("I64"))).gt(a.expirationTimestampSeconds,b)})},p=function(a,b){var e=(j||(j=d("I64"))).of_float(c("useServerTime")().valueOf()/1e3);return d("ReQL").fromTableAscending(a.table("feature_limits")).filter(function(a){return(b!=null?l(a)||m(a,b)||n(a,b):l(a))&&(j||(j=d("I64"))).gt(a.expirationTimestampSeconds,e)})};function a(){var a=(h||(h=c("useReStore")))();return d("ReQLSuspense").useFirst(function(){return o(a)},[a],f.id+":116")}function b(a){var b=(h||(h=c("useReStore")))(),e=p(b,a);return d("ReQLSuspense").useFirst(function(){return e},[e],f.id+":125")}g.readonlyFeatureLimitQuery=o;g.useReadOnlyFeatureLimitData=a;g.useReadOnlyFeatureLimitDataWithThreadType=b}),98);
__d("useIsReadOnlyFeatureLimitedWithThreadType",["MWPFeatureLimitedData","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=d("MWPFeatureLimitedData").useReadOnlyFeatureLimitDataWithThreadType(a);if(a!=null)return c("gkx")("1908348");else return!1}g["default"]=a}),98);